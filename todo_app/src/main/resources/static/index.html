<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <h2>Create Task</h2>
    <form id="createForm">
        <input type="text" id="createTitle" placeholder="Title" required>
        <input type="text" id="createDescription" placeholder="Description" required>
        <button type="submit">Create</button>
    </form>


    <div class="panel">
        <h2>All Tasks</h2>

        <table id="taskList" style="">
        <th></th>
        </table>

    </div>
<script>
    const baseUrl = '/api/tasks';

   document.getElementById('createForm').addEventListener('submit', async (e) => {
       e.preventDefault();
       const title = document.getElementById('createTitle').value;
       const description = document.getElementById('createDescription').value;
       const status = {
       id:null,
       name:'NOT COMPLETED'
       };
       await fetch(baseUrl, {
           method: 'POST',
           headers: { 'Content-Type': 'application/json' },
           body: JSON.stringify({ title, description,status})
       });
       getAllTasks();
   });
   async function deleteTask(id) {

        await fetch(`${baseUrl}/${id}`, { method: 'DELETE' });
        getAllTasks();
    }
    async function getAllTasks() {
        const res = await fetch(baseUrl);
        const tasks = await res.json();
        const list = document.getElementById('taskList');
        list.innerHTML = '';
        tasks.forEach(task => {
            const div = document.createElement('tr');

            div.className = 'task';
            div.innerHTML = `<td >ID: ${task.id}, Title: ${task.title}, Description: ${task.description}</td>`;
            div.innerHTML += `<td ><button id="${task.id}" onclick="deleteTask(${task.id})">X</button></td>`;
            list.appendChild(div);
        });
    }
    getAllTasks();
</script>
</body>
</html>